Perfect ‚Äî here‚Äôs the revised engineering-ready PRD with your three modifications and the new design considerations integrated cleanly, without disturbing the other parts.

‚∏ª

üß© Feature: AI Wordlist Extraction from Documents

1. Overview

Enable users to upload documents (PDF, TXT, DOCX, XLSX, etc.) and automatically generate a bilingual English‚ÄìMandarin wordlist using LLM-based AI agents.
The AI will first assess the cleanliness of the document, perform preprocessing to remove noise and formatting artifacts, then extract key English words and provide Mandarin translations.

The feature targets English learners who want to quickly build structured bilingual vocabulary lists from their reading materials.

‚∏ª

2. User Story

As a learner who reads English materials in different formats,
I want to upload my documents and automatically get a bilingual wordlist,
so that I can study and review new vocabulary efficiently.

‚∏ª

3. System Responsibilities

Stage	Description	Owner
File Ingestion	Accept and validate uploaded files (.pdf, .txt, .docx, .xlsx)	Frontend + API
Preprocessing	LLM agent evaluates the cleanliness of the document (layout, structure, language ratio, presence of noise) and filters irrelevant text (headers, indexes, captions, etc.). The cleanliness score is hidden and used internally for system processing only.	LLM Agent A (‚ÄúCleaner‚Äù)
Text Extraction	Extracts text from valid sections (page-by-page for PDFs; cell-by-cell for spreadsheets)	Backend Parser
Word Extraction	LLM agent identifies English words and filters out non-word content, duplicates, and high-frequency stop words; maximum of 40 words per document.	LLM Agent B (‚ÄúExtractor‚Äù)
Translation Mapping	For each English word, the system generates a Mandarin translation using a bilingual dictionary and/or LLM fallback	LLM Agent C (‚ÄúTranslator‚Äù)
Output Generation	Compile final bilingual wordlist and export options (.csv, .xlsx, in-app view)	Backend Service


‚∏ª

4. Functional Flow
	1.	Upload: User selects one or multiple documents.
	2.	Pre-analysis: LLM ‚ÄúCleaner‚Äù analyzes document cleanliness and filters out irrelevant text (hidden score).
	3.	Extraction: LLM ‚ÄúExtractor‚Äù identifies and lists up to 40 valid English words.
	4.	Translation: ‚ÄúTranslator‚Äù maps English words to Mandarin equivalents.
	5.	Review & Export: User previews bilingual wordlist ‚Üí saves or exports file.

‚∏ª

5. Acceptance Criteria

ID	Criterion	Pass Condition
AC-1	Multi-format support	PDF, TXT, DOCX, and XLSX files upload successfully.
AC-2	Cleanliness analysis	LLM ‚ÄúCleaner‚Äù filters out >90% unrelated content; internal cleanliness score hidden from user.
AC-3	Word extraction	LLM ‚ÄúExtractor‚Äù lists only valid English words (‚â§40 words, ‚â•95% precision).
AC-4	Translation accuracy	‚â•95% correctness for common vocabulary; fallback handled for rare words.
AC-5	Export	User can download bilingual list as CSV/XLSX without encoding errors.
AC-6	Processing speed	A 30-page PDF completes within 30 seconds (LLM parallelism enabled).


‚∏ª

6. Non-Functional Requirements

Category	Requirement
Scalability	System handles up to 5 concurrent uploads globally; enforce concurrency limit.
Reliability	Auto-retry LLM tasks on timeout/failure up to 3 times.
Security	Uploaded files stored temporarily and auto-deleted after 24 hours unless saved by user.
Observability	Each LLM call logs prompt, token count, latency, and confidence metrics.
Cost Control	Apply token limit and chunked streaming for large documents (>30k tokens).


‚∏ª

7. AI Agent Design

Agent	Role	Input	Output
Cleaner	Assess document cleanliness and remove noise (hidden score)	raw file text	{clean_text}
Extractor	Identify English words (‚â§40) and filter duplicates	clean_text	[word1, word2, ...]
Translator	Map English words to Mandarin	wordlist	[{en, zh}, ...]

LLM Configuration
	‚Ä¢	Model: GLM-Flash (default and only model)
	‚Ä¢	Context Window: ‚â•128k tokens
	‚Ä¢	Chunk Strategy: split by paragraph/page for PDFs; batch by rows for XLSX
	‚Ä¢	Retry Policy: exponential backoff with cached intermediate results

‚∏ª

8. Developer Design Considerations
	1.	Wordlist Limit Enforcement:
	‚Ä¢	Each document must output no more than 40 words.
	‚Ä¢	Apply validation both at the LLM prompt level and the backend post-processing stage.
	2.	Anti-Cheating Measures:
	‚Ä¢	Users should not be able to ‚Äúcheat‚Äù by refreshing and uploading a different document immediately.
	‚Ä¢	Implement upload cooldowns, session locks, or token-based rate limits to prevent circumvention.
	3.	Global Concurrency Control:
	‚Ä¢	The system must enforce a global maximum of 5 active uploads being processed at any time.
	‚Ä¢	New uploads beyond this limit should be queued or blocked with a user-facing notification.

‚∏ª

9. Open Questions for Engineering Review
	1.	How should we define cleanliness thresholds for different document types?
	2.	Should translation use a local bilingual dictionary first before LLM fallback?
	3.	Do we support user-editable wordlists post-generation (CRUD actions)?
	4.	How will costs be tracked per LLM agent (Cleaner / Extractor / Translator)?
	5.	Should translation context (sentence-level) be included for polysemous words?

‚∏ª

Would you like me to extend this version to include a section on rate limiting and concurrency handling architecture (Redis lock design, upload token queues, etc.) next?